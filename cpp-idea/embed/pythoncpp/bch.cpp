#include "bch.h"
#define NOINLINE  __attribute__ ((noinline))
template<>
void joinSegmentToSignatureInPlace<2,1>(LogSignature<2,1>& a, const Segment<2>& b)
{
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,1>(FLogSignature<2,1>& a, const FSegment<2>& b)
{
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,2>(LogSignature<2,2>& a, const Segment<2>& b)
{
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,2>(FLogSignature<2,2>& a, const FSegment<2>& b)
{
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,3>(LogSignature<2,3>& a, const Segment<2>& b)
{
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,3>(FLogSignature<2,3>& a, const FSegment<2>& b)
{
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,4>(LogSignature<2,4>& a, const Segment<2>& b)
{
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,4>(FLogSignature<2,4>& a, const FSegment<2>& b)
{
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,5>(LogSignature<2,5>& a, const Segment<2>& b)
{
    a[13] +=-0.0416666666667*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[1]*b[0]
            -0.00138888888889*a[0]*b[1]*b[1]*b[1]*b[1]
            +0.0833333333333*a[4]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[1]
            +0.00138888888889*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[1]
            -0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[1]*b[1];
    a[12] +=-0.5*a[5]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[1]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]
            +0.00833333333333*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[1]*a[3]*b[0]
            +0.0833333333333*a[3]*b[0]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]
            +0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*b[0]*b[0]*b[1]
            +0.0416666666667*a[0]*a[2]*b[0]*b[1]
            -0.0111111111111*a[0]*a[0]*a[1]*b[0]*b[1]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[1];
    a[11] +=0.00277777777778*a[0]*a[1]*a[1]*a[1]*b[0]
            +0.0833333333333*a[2]*a[2]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00277777777778*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*a[1]*b[1]
            -0.0833333333333*a[4]*b[0]*b[1]
            -0.0833333333333*a[0]*a[4]*b[1]
            +0.00833333333333*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.00277777777778*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0416666666667*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.166666666667*a[1]*a[4]*b[0];
    a[10] +=0.00416666666667*a[0]*a[1]*a[1]*a[1]*b[0]
            -0.0111111111111*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00416666666667*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[1]
            +0.00416666666667*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.0833333333333*a[0]*a[4]*b[1]
            +0.00555555555556*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.166666666667*a[4]*b[0]*b[1]
            -0.5*a[7]*b[0]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0];
    a[9] +=0.5*a[5]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[0]
            -0.00416666666667*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.0111111111111*a[0]*a[1]*a[1]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]
            +0.00416666666667*a[0]*a[0]*a[0]*a[1]*b[1]
            -0.5*a[6]*b[0]
            -0.0111111111111*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[0]
            -0.166666666667*a[3]*b[0]*b[1]
            +0.0833333333333*a[4]*b[0]*b[0]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.0416666666667*a[1]*a[2]*b[0]*b[0]
            +0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.00416666666667*a[1]*b[0]*b[0]*b[0]*b[1];
    a[8] +=-0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[0]
            +0.0833333333333*a[3]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]
            +0.00555555555556*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.5*a[5]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[2]*b[0]*b[0]
            -0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1];
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,5>(FLogSignature<2,5>& a, const FSegment<2>& b)
{
    a[13] +=-0.0416666666667*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[1]*b[0]
            -0.00138888888889*a[0]*b[1]*b[1]*b[1]*b[1]
            +0.0833333333333*a[4]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[1]
            +0.00138888888889*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[1]
            -0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[1]*b[1];
    a[12] +=-0.5*a[5]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[1]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]
            +0.00833333333333*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[1]*a[3]*b[0]
            +0.0833333333333*a[3]*b[0]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]
            +0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*b[0]*b[0]*b[1]
            +0.0416666666667*a[0]*a[2]*b[0]*b[1]
            -0.0111111111111*a[0]*a[0]*a[1]*b[0]*b[1]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[1];
    a[11] +=0.00277777777778*a[0]*a[1]*a[1]*a[1]*b[0]
            +0.0833333333333*a[2]*a[2]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00277777777778*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*a[1]*b[1]
            -0.0833333333333*a[4]*b[0]*b[1]
            -0.0833333333333*a[0]*a[4]*b[1]
            +0.00833333333333*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.00277777777778*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0416666666667*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.166666666667*a[1]*a[4]*b[0];
    a[10] +=0.00416666666667*a[0]*a[1]*a[1]*a[1]*b[0]
            -0.0111111111111*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00416666666667*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[1]
            +0.00416666666667*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.0833333333333*a[0]*a[4]*b[1]
            +0.00555555555556*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.166666666667*a[4]*b[0]*b[1]
            -0.5*a[7]*b[0]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0];
    a[9] +=0.5*a[5]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[0]
            -0.00416666666667*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.0111111111111*a[0]*a[1]*a[1]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]
            +0.00416666666667*a[0]*a[0]*a[0]*a[1]*b[1]
            -0.5*a[6]*b[0]
            -0.0111111111111*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[0]
            -0.166666666667*a[3]*b[0]*b[1]
            +0.0833333333333*a[4]*b[0]*b[0]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.0416666666667*a[1]*a[2]*b[0]*b[0]
            +0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.00416666666667*a[1]*b[0]*b[0]*b[0]*b[1];
    a[8] +=-0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[0]
            +0.0833333333333*a[3]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]
            +0.00555555555556*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.5*a[5]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[2]*b[0]*b[0]
            -0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1];
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
    a[1] += b[1];
    a[0] += b[0];
}
static void NOINLINE internal0(LogSignature<2,6>& a, const Segment<2>& b)
{
    a[22] +=-0.000694444444444*a[1]*a[1]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[7]*b[1]
            +0.5*a[13]*b[1]
            +0.000694444444444*a[0]*a[1]*b[1]*b[1]*b[1]*b[1]
            -0.00555555555556*a[1]*a[2]*b[1]*b[1]*b[1]
            +0.0833333333333*a[7]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[2]*b[1]*b[1]*b[1]*b[1]
            +0.000694444444444*a[0]*a[1]*a[1]*a[1]*b[1]*b[1]
            -0.0416666666667*a[1]*a[4]*b[1]*b[1]
            +0.00277777777778*a[0]*a[1]*a[1]*b[1]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*a[1]*b[0]*b[1]*b[1]
            -0.000694444444444*a[1]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.00138888888889*a[1]*a[1]*a[1]*a[2]*b[1];
    a[21] +=-0.0138888888889*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            -0.25*a[5]*b[1]*b[1]
            -0.0277777777778*a[0]*a[1]*a[2]*b[0]*b[1]
            +0.00694444444444*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.166666666667*a[2]*a[4]*b[0]
            -0.166666666667*a[1]*a[6]*b[0]
            -0.00347222222222*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00694444444444*a[0]*a[0]*a[1]*a[2]*b[1]
            -0.208333333333*a[1]*a[3]*b[0]*b[1]
            +0.25*a[1]*a[5]*b[1]
            +0.0277777777778*a[0]*a[2]*b[0]*b[1]*b[1]
            +0.00347222222222*a[0]*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0416666666667*a[0]*a[3]*b[1]*b[1]
            +0.0138888888889*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0833333333333*a[6]*b[0]*b[1]
            -0.5*a[9]*b[1]
            +0.00347222222222*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            -0.00347222222222*a[0]*a[1]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[4]*b[0]*b[1]
            +1.0*a[12]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]*b[1];
    a[20] +=0.0416666666667*a[2]*a[2]*b[1]*b[1]
            +0.00347222222222*a[0]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[10]*b[1]
            -0.0833333333333*a[0]*a[7]*b[1]
            +0.00694444444444*a[1]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0138888888889*a[1]*a[2]*b[0]*b[1]*b[1]
            +0.00694444444444*a[2]*b[0]*b[1]*b[1]*b[1]
            +0.166666666667*a[6]*b[1]*b[1]
            -0.166666666667*a[1]*a[6]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]*b[1]
            -0.00694444444444*a[0]*a[0]*a[1]*b[1]*b[1]*b[1]
            -0.0138888888889*a[1]*a[1]*a[2]*b[0]*b[1]
            +0.166666666667*a[1]*a[7]*b[0]
            -0.00347222222222*a[0]*a[0]*a[1]*a[1]*b[1]*b[1]
            +0.0138888888889*a[0]*a[2]*b[1]*b[1]*b[1]
            -0.00347222222222*a[0]*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00347222222222*a[1]*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[7]*b[0]*b[1]
            -0.00694444444444*a[0]*a[1]*a[1]*a[2]*b[1]
            +0.0833333333333*a[2]*a[4]*b[1]
            +0.125*a[1]*a[4]*b[0]*b[1]
            +0.5*a[11]*b[1]
            -0.0138888888889*a[0]*a[1]*a[2]*b[1]*b[1];
    a[19] +=0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0]*b[1]
            +0.0833333333333*a[0]*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0166666666667*a[1]*a[2]*b[0]*b[1]*b[1]
            +0.00555555555556*a[2]*b[0]*b[1]*b[1]*b[1]
            +0.0833333333333*a[6]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[2]*b[0]
            -0.0833333333333*a[1]*a[6]*b[1]
            -0.0416666666667*a[1]*a[3]*b[1]*b[1]
            -0.00555555555556*a[0]*a[0]*a[1]*b[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[7]*b[0]
            -0.5*a[13]*b[0]
            -0.00208333333333*a[0]*a[0]*a[1]*a[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[2]*b[1]*b[1]*b[1]
            -0.000694444444444*a[0]*a[0]*b[1]*b[1]*b[1]*b[1]
            -0.00138888888889*a[0]*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00208333333333*a[1]*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[1]*a[1]*a[2]*b[1]
            -0.166666666667*a[7]*b[0]*b[1]
            +0.0416666666667*a[0]*a[4]*b[1]*b[1]
            +0.5*a[10]*b[1]
            +0.000694444444444*a[1]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*a[2]*b[1]*b[1];
    a[18] +=0.00416666666667*a[0]*a[0]*a[0]*b[0]*b[1]*b[1]
            +0.25*a[5]*b[0]*b[1]
            +0.000694444444444*a[0]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.00833333333333*a[0]*a[1]*a[2]*b[0]*b[0]
            -0.5*a[12]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.0833333333333*a[2]*a[3]*b[0]
            -0.00416666666667*a[2]*b[0]*b[0]*b[0]*b[1]
            +0.00277777777778*a[1]*a[2]*b[0]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]*b[0]
            +0.00833333333333*a[0]*a[0]*a[2]*b[0]*b[1]
            -0.000694444444444*a[0]*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0416666666667*a[2]*a[2]*b[0]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[2]*b[0]
            -0.0194444444444*a[0]*a[2]*b[0]*b[0]*b[1]
            +0.00277777777778*a[0]*a[0]*a[0]*a[2]*b[1]
            -1.0*a[8]*b[1]
            +0.000694444444444*a[0]*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[3]*b[0]*b[1]
            -0.25*a[1]*a[5]*b[0]
            -0.00416666666667*a[0]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[1]*a[1]*b[0]*b[0]*b[0]*b[0];
    a[17] +=0.00277777777778*a[0]*a[1]*a[1]*a[2]*b[0]
            -0.00138888888889*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[2]*a[3]*b[1]
            -0.00416666666667*a[1]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[1]*a[2]*b[0]*b[0]*b[1]
            +0.00555555555556*a[0]*a[1]*a[2]*b[0]*b[1]
            +0.00833333333333*a[0]*a[0]*a[2]*b[1]*b[1]
            -0.00555555555556*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.0833333333333*a[2]*a[4]*b[0]
            +0.0833333333333*a[1]*a[6]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[0]*b[0]
            -0.0111111111111*a[0]*a[2]*b[0]*b[1]*b[1]
            -0.5*a[11]*b[0]
            +0.00277777777778*a[0]*a[0]*a[1]*a[2]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.00416666666667*a[0]*a[0]*a[0]*b[1]*b[1]*b[1]
            -0.166666666667*a[6]*b[0]*b[1]
            +0.5*a[9]*b[1]
            -0.00138888888889*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.00138888888889*a[0]*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[2]*b[0]*b[0]
            +0.5*a[12]*b[1];
    a[16] +=0.00416666666667*a[0]*a[1]*a[1]*a[2]*b[0]
            +0.00833333333333*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[5]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00208333333333*a[0]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0166666666667*a[1]*a[2]*b[0]*b[0]*b[1]
            +0.0222222222222*a[0]*a[1]*a[2]*b[0]*b[1]
            -0.5*a[10]*b[0]
            +0.0833333333333*a[7]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[2]*b[1]*b[1]
            -0.00833333333333*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.00208333333333*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            +0.00208333333333*a[0]*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0416666666667*a[1]*a[4]*b[0]*b[0]
            +0.00416666666667*a[0]*a[0]*a[1]*a[2]*b[1]
            +0.0833333333333*a[1]*a[3]*b[0]*b[1]
            -0.0833333333333*a[1]*a[5]*b[1]
            -0.0166666666667*a[0]*a[2]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[7]*b[0]
            +0.0416666666667*a[0]*a[3]*b[1]*b[1]
            -0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]*b[1]
            -0.166666666667*a[6]*b[0]*b[1]
            +0.5*a[9]*b[1]
            -0.00208333333333*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.0833333333333*a[1]*a[6]*b[0]
            +0.00555555555556*a[1]*a[1]*a[2]*b[0]*b[0]
            -0.0833333333333*a[0]*a[4]*b[0]*b[1];
}
static void NOINLINE internal1(LogSignature<2,6>& a, const Segment<2>& b)
{
    a[15] +=-0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[5]*b[0]*b[1]
            +0.00138888888889*a[0]*a[1]*b[0]*b[0]*b[0]*b[1]
            -0.0111111111111*a[0]*a[1]*a[2]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*a[5]*b[1]
            +0.00555555555556*a[2]*b[0]*b[0]*b[0]*b[1]
            +0.00555555555556*a[1]*a[2]*b[0]*b[0]*b[0]
            -0.0416666666667*a[1]*a[3]*b[0]*b[0]
            -0.0111111111111*a[0]*a[0]*a[2]*b[0]*b[1]
            +0.00208333333333*a[0]*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[2]*b[0]
            +0.0166666666667*a[0]*a[2]*b[0]*b[0]*b[1]
            -0.5*a[9]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[2]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]*b[1]
            -0.0833333333333*a[0]*a[6]*b[0]
            -0.00208333333333*a[0]*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[4]*b[0]*b[0]
            +0.0833333333333*a[6]*b[0]*b[0]
            +0.5*a[8]*b[1]
            +0.0833333333333*a[1]*a[5]*b[0]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.000694444444444*a[1]*a[1]*b[0]*b[0]*b[0]*b[0];
    a[14] +=-0.00555555555556*a[0]*a[2]*b[0]*b[0]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[2]*b[0]
            +0.000694444444444*a[0]*a[0]*b[0]*b[0]*b[0]*b[1]
            +0.0833333333333*a[5]*b[0]*b[0]
            -0.0833333333333*a[0]*a[5]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[2]*b[0]*b[0]*b[0]*b[0]
            +0.000694444444444*a[0]*a[0]*a[0]*a[0]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[2]*b[0]*b[0]
            -0.000694444444444*a[0]*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[3]*b[0]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[1]*b[0]*b[0]
            -0.5*a[8]*b[0];
    a[13] +=-0.0416666666667*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[1]*b[0]
            -0.00138888888889*a[0]*b[1]*b[1]*b[1]*b[1]
            +0.0833333333333*a[4]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[1]
            +0.00138888888889*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[1]
            -0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[1]*b[1];
    a[12] +=-0.5*a[5]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[1]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]
            +0.00833333333333*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[1]*a[3]*b[0]
            +0.0833333333333*a[3]*b[0]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]
            +0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*b[0]*b[0]*b[1]
            +0.0416666666667*a[0]*a[2]*b[0]*b[1]
            -0.0111111111111*a[0]*a[0]*a[1]*b[0]*b[1]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[1];
    a[11] +=0.00277777777778*a[0]*a[1]*a[1]*a[1]*b[0]
            +0.0833333333333*a[2]*a[2]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00277777777778*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*a[1]*b[1]
            -0.0833333333333*a[4]*b[0]*b[1]
            +0.00833333333333*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.00277777777778*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0416666666667*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.166666666667*a[1]*a[4]*b[0];
    a[10] +=0.00416666666667*a[0]*a[1]*a[1]*a[1]*b[0]
            -0.0111111111111*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00416666666667*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[1]
            +0.00416666666667*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.00555555555556*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.166666666667*a[4]*b[0]*b[1]
            -0.5*a[7]*b[0]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[0]*a[4]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0];
    a[9] +=0.5*a[5]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[0]
            -0.00416666666667*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.0111111111111*a[0]*a[1]*a[1]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]
            +0.00416666666667*a[0]*a[0]*a[0]*a[1]*b[1]
            -0.5*a[6]*b[0]
            -0.0111111111111*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[0]
            -0.166666666667*a[3]*b[0]*b[1]
            +0.0833333333333*a[4]*b[0]*b[0]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.0416666666667*a[1]*a[2]*b[0]*b[0]
            +0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.00416666666667*a[1]*b[0]*b[0]*b[0]*b[1];
}
static void NOINLINE internal2(LogSignature<2,6>& a, const Segment<2>& b)
{
    a[8] +=-0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[0]
            +0.0833333333333*a[3]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]
            +0.00555555555556*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.5*a[5]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[2]*b[0]*b[0]
            -0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1];
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
}
static void NOINLINE internal3(LogSignature<2,6>& a, const Segment<2>& b)
{
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,6>(LogSignature<2,6>& a, const Segment<2>& b)
{
    internal0(a,b);
    internal1(a,b);
    internal2(a,b);
    internal3(a,b);
}
static void NOINLINE internal4(FLogSignature<2,6>& a, const FSegment<2>& b)
{
    a[22] +=-0.000694444444444*a[1]*a[1]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[7]*b[1]
            +0.5*a[13]*b[1]
            +0.000694444444444*a[0]*a[1]*b[1]*b[1]*b[1]*b[1]
            -0.00555555555556*a[1]*a[2]*b[1]*b[1]*b[1]
            +0.0833333333333*a[7]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[2]*b[1]*b[1]*b[1]*b[1]
            +0.000694444444444*a[0]*a[1]*a[1]*a[1]*b[1]*b[1]
            -0.0416666666667*a[1]*a[4]*b[1]*b[1]
            +0.00277777777778*a[0]*a[1]*a[1]*b[1]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*a[1]*b[0]*b[1]*b[1]
            -0.000694444444444*a[1]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.00138888888889*a[1]*a[1]*a[1]*a[2]*b[1];
    a[21] +=-0.0138888888889*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            -0.25*a[5]*b[1]*b[1]
            -0.0277777777778*a[0]*a[1]*a[2]*b[0]*b[1]
            +0.00694444444444*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.166666666667*a[2]*a[4]*b[0]
            -0.166666666667*a[1]*a[6]*b[0]
            -0.00347222222222*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00694444444444*a[0]*a[0]*a[1]*a[2]*b[1]
            -0.208333333333*a[1]*a[3]*b[0]*b[1]
            +0.25*a[1]*a[5]*b[1]
            +0.0277777777778*a[0]*a[2]*b[0]*b[1]*b[1]
            +0.00347222222222*a[0]*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0416666666667*a[0]*a[3]*b[1]*b[1]
            +0.0138888888889*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0833333333333*a[6]*b[0]*b[1]
            -0.5*a[9]*b[1]
            +0.00347222222222*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            -0.00347222222222*a[0]*a[1]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[4]*b[0]*b[1]
            +1.0*a[12]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]*b[1];
    a[20] +=0.0416666666667*a[2]*a[2]*b[1]*b[1]
            +0.00347222222222*a[0]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[10]*b[1]
            -0.0833333333333*a[0]*a[7]*b[1]
            +0.00694444444444*a[1]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0138888888889*a[1]*a[2]*b[0]*b[1]*b[1]
            +0.00694444444444*a[2]*b[0]*b[1]*b[1]*b[1]
            +0.166666666667*a[6]*b[1]*b[1]
            -0.166666666667*a[1]*a[6]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]*b[1]
            -0.00694444444444*a[0]*a[0]*a[1]*b[1]*b[1]*b[1]
            -0.0138888888889*a[1]*a[1]*a[2]*b[0]*b[1]
            +0.166666666667*a[1]*a[7]*b[0]
            -0.00347222222222*a[0]*a[0]*a[1]*a[1]*b[1]*b[1]
            +0.0138888888889*a[0]*a[2]*b[1]*b[1]*b[1]
            -0.00347222222222*a[0]*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00347222222222*a[1]*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[7]*b[0]*b[1]
            -0.00694444444444*a[0]*a[1]*a[1]*a[2]*b[1]
            +0.0833333333333*a[2]*a[4]*b[1]
            +0.125*a[1]*a[4]*b[0]*b[1]
            +0.5*a[11]*b[1]
            -0.0138888888889*a[0]*a[1]*a[2]*b[1]*b[1];
    a[19] +=0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0]*b[1]
            +0.0833333333333*a[0]*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.0166666666667*a[1]*a[2]*b[0]*b[1]*b[1]
            +0.00555555555556*a[2]*b[0]*b[1]*b[1]*b[1]
            +0.0833333333333*a[6]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[2]*b[0]
            -0.0833333333333*a[1]*a[6]*b[1]
            -0.0416666666667*a[1]*a[3]*b[1]*b[1]
            -0.00555555555556*a[0]*a[0]*a[1]*b[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[7]*b[0]
            -0.5*a[13]*b[0]
            -0.00208333333333*a[0]*a[0]*a[1]*a[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[2]*b[1]*b[1]*b[1]
            -0.000694444444444*a[0]*a[0]*b[1]*b[1]*b[1]*b[1]
            -0.00138888888889*a[0]*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00208333333333*a[1]*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[1]*a[1]*a[2]*b[1]
            -0.166666666667*a[7]*b[0]*b[1]
            +0.0416666666667*a[0]*a[4]*b[1]*b[1]
            +0.5*a[10]*b[1]
            +0.000694444444444*a[1]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*a[2]*b[1]*b[1];
    a[18] +=0.00416666666667*a[0]*a[0]*a[0]*b[0]*b[1]*b[1]
            +0.25*a[5]*b[0]*b[1]
            +0.000694444444444*a[0]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.00833333333333*a[0]*a[1]*a[2]*b[0]*b[0]
            -0.5*a[12]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.0833333333333*a[2]*a[3]*b[0]
            -0.00416666666667*a[2]*b[0]*b[0]*b[0]*b[1]
            +0.00277777777778*a[1]*a[2]*b[0]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]*b[0]
            +0.00833333333333*a[0]*a[0]*a[2]*b[0]*b[1]
            -0.000694444444444*a[0]*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0416666666667*a[2]*a[2]*b[0]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[2]*b[0]
            -0.0194444444444*a[0]*a[2]*b[0]*b[0]*b[1]
            +0.00277777777778*a[0]*a[0]*a[0]*a[2]*b[1]
            -1.0*a[8]*b[1]
            +0.000694444444444*a[0]*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[3]*b[0]*b[1]
            -0.25*a[1]*a[5]*b[0]
            -0.00416666666667*a[0]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[1]*a[1]*b[0]*b[0]*b[0]*b[0];
    a[17] +=0.00277777777778*a[0]*a[1]*a[1]*a[2]*b[0]
            -0.00138888888889*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[2]*a[3]*b[1]
            -0.00416666666667*a[1]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[1]*a[2]*b[0]*b[0]*b[1]
            +0.00555555555556*a[0]*a[1]*a[2]*b[0]*b[1]
            +0.00833333333333*a[0]*a[0]*a[2]*b[1]*b[1]
            -0.00555555555556*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.0833333333333*a[2]*a[4]*b[0]
            +0.0833333333333*a[1]*a[6]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[0]*b[0]
            -0.0111111111111*a[0]*a[2]*b[0]*b[1]*b[1]
            -0.5*a[11]*b[0]
            +0.00277777777778*a[0]*a[0]*a[1]*a[2]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.00416666666667*a[0]*a[0]*a[0]*b[1]*b[1]*b[1]
            -0.166666666667*a[6]*b[0]*b[1]
            +0.5*a[9]*b[1]
            -0.00138888888889*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.00138888888889*a[0]*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[2]*b[0]*b[0]
            +0.5*a[12]*b[1];
    a[16] +=0.00416666666667*a[0]*a[1]*a[1]*a[2]*b[0]
            +0.00833333333333*a[0]*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.0833333333333*a[5]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*a[1]*b[0]*b[0]*b[0]
            -0.00208333333333*a[0]*a[1]*a[1]*a[1]*b[0]*b[0]
            -0.0166666666667*a[1]*a[2]*b[0]*b[0]*b[1]
            +0.0222222222222*a[0]*a[1]*a[2]*b[0]*b[1]
            -0.5*a[10]*b[0]
            +0.0833333333333*a[7]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[2]*b[1]*b[1]
            -0.00833333333333*a[2]*b[0]*b[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[6]*b[1]
            +0.00208333333333*a[0]*a[0]*a[0]*a[1]*b[1]*b[1]
            +0.00208333333333*a[0]*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0416666666667*a[1]*a[4]*b[0]*b[0]
            +0.00416666666667*a[0]*a[0]*a[1]*a[2]*b[1]
            +0.0833333333333*a[1]*a[3]*b[0]*b[1]
            -0.0833333333333*a[1]*a[5]*b[1]
            -0.0166666666667*a[0]*a[2]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[7]*b[0]
            +0.0416666666667*a[0]*a[3]*b[1]*b[1]
            -0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]*b[1]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]*b[1]
            -0.166666666667*a[6]*b[0]*b[1]
            +0.5*a[9]*b[1]
            -0.00208333333333*a[1]*a[1]*b[0]*b[0]*b[0]*b[1]
            +0.0833333333333*a[1]*a[6]*b[0]
            +0.00555555555556*a[1]*a[1]*a[2]*b[0]*b[0]
            -0.0833333333333*a[0]*a[4]*b[0]*b[1];
}
static void NOINLINE internal5(FLogSignature<2,6>& a, const FSegment<2>& b)
{
    a[15] +=-0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[5]*b[0]*b[1]
            +0.00138888888889*a[0]*a[1]*b[0]*b[0]*b[0]*b[1]
            -0.0111111111111*a[0]*a[1]*a[2]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*a[5]*b[1]
            +0.00555555555556*a[2]*b[0]*b[0]*b[0]*b[1]
            +0.00555555555556*a[1]*a[2]*b[0]*b[0]*b[0]
            -0.0416666666667*a[1]*a[3]*b[0]*b[0]
            -0.0111111111111*a[0]*a[0]*a[2]*b[0]*b[1]
            +0.00208333333333*a[0]*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[2]*b[0]
            +0.0166666666667*a[0]*a[2]*b[0]*b[0]*b[1]
            -0.5*a[9]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[2]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]*b[1]
            -0.0833333333333*a[0]*a[6]*b[0]
            -0.00208333333333*a[0]*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.0416666666667*a[0]*a[4]*b[0]*b[0]
            +0.0833333333333*a[6]*b[0]*b[0]
            +0.5*a[8]*b[1]
            +0.0833333333333*a[1]*a[5]*b[0]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.000694444444444*a[1]*a[1]*b[0]*b[0]*b[0]*b[0];
    a[14] +=-0.00555555555556*a[0]*a[2]*b[0]*b[0]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[2]*b[0]
            +0.000694444444444*a[0]*a[0]*b[0]*b[0]*b[0]*b[1]
            +0.0833333333333*a[5]*b[0]*b[0]
            -0.0833333333333*a[0]*a[5]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[0]*b[0]*b[0]
            -0.00138888888889*a[2]*b[0]*b[0]*b[0]*b[0]
            +0.000694444444444*a[0]*a[0]*a[0]*a[0]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[2]*b[0]*b[0]
            -0.000694444444444*a[0]*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[3]*b[0]*b[0]
            -0.000694444444444*a[0]*a[0]*a[0]*a[1]*b[0]*b[0]
            -0.5*a[8]*b[0];
    a[13] +=-0.0416666666667*a[1]*a[2]*b[1]*b[1]
            -0.00138888888889*a[1]*a[1]*a[1]*a[1]*b[0]
            -0.00138888888889*a[0]*b[1]*b[1]*b[1]*b[1]
            +0.0833333333333*a[4]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[1]*b[1]
            -0.0833333333333*a[1]*a[4]*b[1]
            +0.00138888888889*a[1]*b[0]*b[1]*b[1]*b[1]
            +0.00138888888889*a[0]*a[1]*a[1]*a[1]*b[1]
            -0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[1]
            +0.5*a[7]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[1]*b[1];
    a[12] +=-0.5*a[5]*b[1]
            +0.00138888888889*a[0]*a[0]*a[1]*a[1]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00277777777778*a[0]*a[0]*a[0]*b[1]*b[1]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[1]
            +0.00833333333333*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.166666666667*a[1]*a[3]*b[0]
            +0.0833333333333*a[3]*b[0]*b[1]
            +0.0833333333333*a[2]*a[2]*b[0]
            +0.00833333333333*a[0]*a[1]*a[1]*b[0]*b[0]
            -0.0111111111111*a[0]*a[1]*b[0]*b[0]*b[1]
            +0.0416666666667*a[0]*a[2]*b[0]*b[1]
            -0.0111111111111*a[0]*a[0]*a[1]*b[0]*b[1]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[1];
    a[11] +=0.00277777777778*a[0]*a[1]*a[1]*a[1]*b[0]
            +0.0833333333333*a[2]*a[2]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            -0.00277777777778*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00277777777778*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*a[1]*b[1]
            -0.0833333333333*a[4]*b[0]*b[1]
            +0.00833333333333*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00833333333333*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.00277777777778*a[0]*b[0]*b[1]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[1]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0416666666667*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            -0.00277777777778*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.166666666667*a[1]*a[4]*b[0];
    a[10] +=0.00416666666667*a[0]*a[1]*a[1]*a[1]*b[0]
            -0.0111111111111*a[0]*a[0]*a[1]*b[1]*b[1]
            -0.0111111111111*a[1]*a[1]*b[0]*b[0]*b[1]
            -0.00416666666667*a[1]*b[0]*b[0]*b[1]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[1]
            +0.00416666666667*a[0]*b[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*b[0]*b[1]*b[1]
            +0.00555555555556*a[0]*a[0]*b[1]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*a[1]*b[0]*b[0]
            +0.5*a[6]*b[1]
            -0.166666666667*a[4]*b[0]*b[1]
            -0.5*a[7]*b[0]
            -0.0833333333333*a[1]*a[3]*b[1]
            +0.0833333333333*a[3]*b[1]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0]*b[1]
            +0.0833333333333*a[0]*a[4]*b[1]
            +0.0416666666667*a[0]*a[2]*b[1]*b[1]
            +0.00555555555556*a[0]*a[1]*a[1]*b[0]*b[1]
            +0.0833333333333*a[1]*a[4]*b[0];
    a[9] +=0.5*a[5]*b[1]
            -0.00416666666667*a[0]*a[0]*a[1]*a[1]*b[0]
            -0.00416666666667*a[0]*b[0]*b[0]*b[1]*b[1]
            +0.00555555555556*a[1]*a[1]*b[0]*b[0]*b[0]
            +0.00555555555556*a[0]*a[0]*a[0]*b[1]*b[1]
            -0.0111111111111*a[0]*a[1]*a[1]*b[0]*b[0]
            +0.0833333333333*a[1]*a[3]*b[0]
            +0.00416666666667*a[0]*a[0]*a[0]*a[1]*b[1]
            -0.5*a[6]*b[0]
            -0.0111111111111*a[0]*a[0]*b[0]*b[1]*b[1]
            -0.0833333333333*a[0]*a[4]*b[0]
            -0.166666666667*a[3]*b[0]*b[1]
            +0.0833333333333*a[4]*b[0]*b[0]
            +0.0833333333333*a[0]*a[3]*b[1]
            -0.0416666666667*a[1]*a[2]*b[0]*b[0]
            +0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]*b[1]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[1]
            +0.00416666666667*a[1]*b[0]*b[0]*b[0]*b[1];
}
static void NOINLINE internal6(FLogSignature<2,6>& a, const FSegment<2>& b)
{
    a[8] +=-0.00555555555556*a[0]*a[1]*b[0]*b[0]*b[0]
            +0.0833333333333*a[3]*b[0]*b[0]
            -0.00138888888889*a[0]*a[0]*a[0]*a[0]*b[1]
            +0.00555555555556*a[0]*a[0]*b[0]*b[0]*b[1]
            -0.5*a[5]*b[0]
            +0.00138888888889*a[0]*a[0]*a[0]*a[1]*b[0]
            +0.00555555555556*a[0]*a[0]*a[1]*b[0]*b[0]
            +0.00138888888889*a[0]*b[0]*b[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[3]*b[0]
            -0.00138888888889*a[1]*b[0]*b[0]*b[0]*b[0]
            +0.0416666666667*a[0]*a[2]*b[0]*b[0]
            -0.00555555555556*a[0]*a[0]*a[0]*b[0]*b[1];
    a[7] +=-0.0416666666667*a[0]*a[1]*b[1]*b[1]
            +0.0833333333333*a[2]*b[1]*b[1]
            -0.0833333333333*a[1]*a[2]*b[1]
            +0.0416666666667*a[1]*a[1]*b[0]*b[1]
            +0.5*a[4]*b[1];
    a[6] +=0.0833333333333*a[0]*a[2]*b[1]
            +0.5*a[3]*b[1]
            -0.5*a[4]*b[0]
            -0.0416666666667*a[1]*a[1]*b[0]*b[0]
            +0.0416666666667*a[0]*a[0]*b[1]*b[1]
            -0.166666666667*a[2]*b[0]*b[1]
            +0.0833333333333*a[1]*a[2]*b[0];
    a[5] +=0.0416666666667*a[0]*a[1]*b[0]*b[0]
            -0.5*a[3]*b[0]
            -0.0416666666667*a[0]*a[0]*b[0]*b[1]
            -0.0833333333333*a[0]*a[2]*b[0]
            +0.0833333333333*a[2]*b[0]*b[0];
    a[4] +=0.5*a[2]*b[1]
            +0.0833333333333*a[1]*a[1]*b[0]
            -0.0833333333333*a[0]*a[1]*b[1]
            -0.0833333333333*a[1]*b[0]*b[1]
            +0.0833333333333*a[0]*b[1]*b[1];
    a[3] +=-0.0833333333333*a[0]*b[0]*b[1]
            +0.0833333333333*a[1]*b[0]*b[0]
            +0.0833333333333*a[0]*a[0]*b[1]
            -0.5*a[2]*b[0]
            -0.0833333333333*a[0]*a[1]*b[0];
    a[2] +=0.5*a[0]*b[1]
            -0.5*a[1]*b[0];
}
static void NOINLINE internal7(FLogSignature<2,6>& a, const FSegment<2>& b)
{
    a[1] += b[1];
    a[0] += b[0];
}
template<>
void joinSegmentToSignatureInPlace<2,6>(FLogSignature<2,6>& a, const FSegment<2>& b)
{
    internal4(a,b);
    internal5(a,b);
    internal6(a,b);
    internal7(a,b);
}
